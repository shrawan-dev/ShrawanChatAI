<!DOCTYPE html>
<html lang="hi" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ShrawanChatAI Ultra Pro Max</title>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        /* --- ALL THEMES INTEGRATED --- */
        :root[data-theme="dark"] {
            --bg-main: #0b0b0d; --sidebar-bg: #161719; --input-bg: #1e1f21;
            --text-main: #e3e3e3; --text-sub: #9aa0a6; --accent-color: #8ab4f8;
            --msg-user-bg: #2d2e30; --border-color: #3c4043; --card-bg: #1e1f21;
        }
        :root[data-theme="light"] {
            --bg-main: #ffffff; --sidebar-bg: #f0f4f9; --input-bg: #f0f4f9;
            --text-main: #1f1f1f; --text-sub: #5f6368; --accent-color: #1a73e8;
            --msg-user-bg: #e3e3e3; --border-color: #dadce0; --card-bg: #f8f9fa;
        }
        :root[data-theme="blue"] {
            --bg-main: #050a0f; --sidebar-bg: #0d1621; --input-bg: #122030;
            --text-main: #e8eaed; --text-sub: #8696a0; --accent-color: #4db8ff;
            --msg-user-bg: #004d40; --border-color: #1f3a5f; --card-bg: #162a44;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Google Sans', sans-serif; }
        body { background: var(--bg-main); color: var(--text-main); height: 100dvh; display: flex; overflow: hidden; transition: 0.3s; }

        /* --- SIDEBAR & NAVIGATION --- */
        .sidebar { position: fixed; left: -300px; width: 280px; height: 100%; background: var(--sidebar-bg); transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); z-index: 1000; border-right: 1px solid var(--border-color); display: flex; flex-direction: column; padding: 15px; }
        .sidebar.active { left: 0; }
        .btn-new { background: var(--bg-main); border: 1px solid var(--border-color); color: var(--text-main); padding: 12px; border-radius: 50px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 20px; font-weight: 500; transition: 0.2s; }
        .btn-new:hover { background: var(--border-color); }
        .history-list { flex: 1; overflow-y: auto; margin-bottom: 15px; }
        .history-item { padding: 10px; border-radius: 8px; font-size: 14px; color: var(--text-sub); cursor: pointer; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .history-item:hover { background: var(--border-color); color: var(--text-main); }
        .theme-selector { border-top: 1px solid var(--border-color); padding: 15px 0; }
        .theme-btns { display: flex; gap: 8px; margin-top: 10px; }
        .theme-btn { flex: 1; padding: 8px; border-radius: 8px; border: 1px solid var(--border-color); background: var(--bg-main); color: var(--text-main); cursor: pointer; font-size: 11px; transition: 0.2s; }
        .theme-btn.active { border-color: var(--accent-color); color: var(--accent-color); }

        /* --- DASHBOARD & 10 PRO ANIMATIONS --- */
        .main-content { flex: 1; display: flex; flex-direction: column; position: relative; width: 100%; }
        .viewport { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; align-items: center; scroll-behavior: smooth; }
        .hero-section { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 60vh; text-align: center; }
        .anim-box { height: 160px; width: 200px; display: flex; align-items: center; justify-content: center; position: relative; }
        
        .char-icon { font-size: 80px; position: absolute; opacity: 0; display: none; filter: drop-shadow(0 0 25px var(--accent-color)); }

        /* Animation Styles for 10 Characters */
        .anim-rocket { animation: rocketFly 2.8s ease-in-out forwards; }
        @keyframes rocketFly { 0% { opacity:0; transform: translateY(100px) rotate(-45deg) scale(0.5); } 30% { opacity:1; transform: translateY(0) rotate(-45deg) scale(1); } 100% { opacity:0; transform: translateY(-200px) rotate(-45deg) scale(1.2); } }

        .anim-comp { animation: coding 2.8s ease-in-out forwards; }
        @keyframes coding { 0% { opacity:0; transform: scale(0.8); } 20% { opacity:1; } 50% { transform: scale(1.1); filter: hue-rotate(90deg); } 100% { opacity:0; transform: scale(1.3); } }

        .anim-fire { animation: fireGlow 2.8s ease-in-out forwards; }
        @keyframes fireGlow { 0% { opacity:0; transform: scale(0.2); filter: blur(20px); } 50% { opacity:1; transform: scale(1.4); filter: blur(0); } 100% { opacity:0; transform: scale(2); filter: blur(10px); } }

        .anim-robot { animation: robotWalk 2.8s ease-in-out forwards; }
        @keyframes robotWalk { 0% { opacity:0; transform: translateX(-60px); } 50% { opacity:1; transform: translateX(0); } 100% { opacity:0; transform: translateX(60px); } }

        .shrawan-title { font-size: clamp(35px, 7vw, 60px); font-weight: 800; background: linear-gradient(90deg, #4285f4, #9b72cb, #d96570, #fbbc04, #4285f4); background-size: 300%; -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: gradientText 4s linear infinite; margin-top: 10px; }
        @keyframes gradientText { 0% { background-position: 0%; } 100% { background-position: 300%; } }

        /* --- CHAT FLOW --- */
        #chat-flow { width: 100%; max-width: 850px; display: none; flex-direction: column; gap: 30px; padding-bottom: 160px; padding-top: 20px; }
        .msg-container { width: 100%; display: flex; flex-direction: column; }
        .user-msg { align-self: flex-end; background: var(--msg-user-bg); padding: 15px 22px; border-radius: 25px 25px 4px 25px; max-width: 85%; border: 1px solid var(--border-color); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .bot-msg { align-self: flex-start; width: 100%; position: relative; font-size: 16px; line-height: 1.8; }
        
        .illegal-warning { border: 4px solid #ff3b30; color: #ff3b30; padding: 25px; border-radius: 20px; text-align: center; font-weight: 800; animation: shakeDanger 0.3s infinite; background: rgba(255,0,0,0.1); font-size: 22px; margin: 10px 0; text-shadow: 0 0 10px rgba(255,0,0,0.3); }
        @keyframes shakeDanger { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }

        /* --- BOTTOM INPUT BAR --- */
        .bottom-bar { position: fixed; bottom: 0; width: 100%; padding: 20px; background: linear-gradient(transparent, var(--bg-main) 60%); display: flex; flex-direction: column; align-items: center; }
        .input-box { width: 100%; max-width: 850px; background: var(--input-bg); border: 1px solid var(--border-color); border-radius: 40px; display: flex; align-items: center; padding: 8px 20px; box-shadow: 0 10px 35px rgba(0,0,0,0.4); }
        #user-input { flex: 1; background: transparent; border: none; color: var(--text-main); padding: 12px; outline: none; font-size: 17px; }

        .adam-voice-btn { color: var(--accent-color); margin-right: 15px; cursor: pointer; font-size: 30px !important; transition: 0.3s; }
        .adam-voice-btn.active { color: #ff3b30; transform: scale(1.2); filter: drop-shadow(0 0 8px #ff3b30); }

        #preview-box { display: none; width: 100%; max-width: 850px; margin-bottom: 12px; position: relative; }
        #preview-img { height: 80px; border-radius: 12px; border: 2px solid var(--accent-color); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }

        .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 2000; justify-content: center; align-items: center; backdrop-filter: blur(10px); }
        .modal-card { background: var(--sidebar-bg); padding: 40px; border-radius: 25px; width: 90%; max-width: 450px; text-align: center; border: 1px solid var(--border-color); }
        .modal-card input { width: 100%; padding: 15px; margin: 20px 0; border-radius: 12px; border: 1px solid var(--border-color); background: var(--bg-main); color: white; outline: none; }
        
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 10px; }
    </style>
</head>
<body>

<div id="setup-modal" class="modal-overlay">
    <div class="modal-card">
        <h2 style="color: var(--accent-color);">üöÄ ShrawanChatAI Setup</h2>
        <p style="color:var(--text-sub); margin-top:10px;">Enter your OpenRouter API Key to begin.</p>
        <input type="password" id="api-key-input" placeholder="sk-or-v1-xxxxxxxxxxxx">
        <button onclick="saveApiKey()" style="width:100%; padding:15px; border-radius:12px; background:var(--accent-color); border:none; color:white; font-weight:bold; cursor:pointer; font-size:16px;">Launch Super AI üî•</button>
    </div>
</div>

<aside id="sidebar" class="sidebar">
    <button class="btn-new" onclick="location.reload()"><span class="material-icons">add</span> New Chat Session</button>
    <div class="history-list" id="chat-history"></div>
    
    <div class="theme-selector">
        <p style="font-size:12px; color:var(--text-sub); font-weight:bold;">APPEARANCE MODE</p>
        <div class="theme-btns">
            <button class="theme-btn active" id="t-dark" onclick="setTheme('dark')">Dark</button>
            <button class="theme-btn" id="t-light" onclick="setTheme('light')">Light</button>
            <button class="theme-btn" id="t-blue" onclick="setTheme('blue')">Deep Blue</button>
        </div>
    </div>
    <button onclick="document.getElementById('setup-modal').style.display='flex'" style="background:none; border:none; color:var(--text-sub); cursor:pointer; padding:10px; display:flex; align-items:center; gap:10px;"><span class="material-icons">settings</span> Settings</button>
</aside>

<div class="main-content">
    <header style="padding:15px;"><span class="material-icons" style="cursor:pointer; font-size:30px;" onclick="toggleSidebar()">menu</span></header>
    
    <div class="viewport">
        <div id="dashboard-ui" class="hero-section">
            <div class="anim-box" id="animation-container"></div>
            <h1 class="shrawan-title">I Am ShrawanChatAI</h1>
            <p style="color:var(--text-sub); margin-top:15px; font-weight:500; letter-spacing:1px;">PROFESSIONAL DASHBOARD ‚Ä¢ YOUTUBE SEO ‚Ä¢ VISION AI</p>
        </div>

        <div id="chat-flow"></div>
    </div>

    <div class="bottom-bar">
        <div id="preview-box">
            <img id="preview-img" src="">
            <button onclick="clearImage()" style="position:absolute; top:-8px; left:72px; background:#ff3b30; color:white; border:none; border-radius:50%; width:24px; height:24px; cursor:pointer; display:flex; align-items:center; justify-content:center; font-weight:bold;">√ó</button>
        </div>
        
        <div class="input-box">
            <span class="material-icons adam-voice-btn" id="adam-trigger" onclick="handleVoicePlayback()" title="Adam Pro Voice (Play/Pause)">play_circle_filled</span>
            
            <input type="file" id="gallery-input" accept="image/*" style="display:none;" onchange="handleImage(event)">
            <span class="material-icons" style="cursor:pointer; color:var(--text-sub); margin-right:15px;" onclick="document.getElementById('gallery-input').click()">add_photo_alternate</span>
            
            <input type="text" id="user-input" placeholder="Ask ShrawanChatAI anything..." onkeypress="if(event.key==='Enter') startInference()">
            
            <span class="material-icons" style="cursor:pointer; color:var(--text-sub); margin-right:15px; font-size:28px;" onclick="startSpeechToText()">mic</span>
            
            <span class="material-icons" style="color:var(--accent-color); cursor:pointer; font-size:35px;" onclick="startInference()">send</span>
        </div>
    </div>
</div>

<script>
    let API_KEY = localStorage.getItem('shrawan_ai_key') || "";
    let currentImageBase64 = null;
    let globalBotReply = "";
    let synth = window.speechSynthesis;
    let currentUtterance = null;
    let isPaused = false;

    // --- 10 PROFESSIONAL CHARACTER ANIMATIONS ---
    const iconData = [
        { e: 'üöÄ', c: 'anim-rocket' }, { e: 'üíª', c: 'anim-comp' }, { e: 'üî•', c: 'anim-fire' },
        { e: 'ü§ñ', c: 'anim-robot' }, { e: 'üß†', c: 'anim-comp' }, { e: '‚ö°', c: 'anim-fire' },
        { e: 'üìà', c: 'anim-robot' }, { e: 'üí°', c: 'anim-comp' }, { e: '‚ú®', c: 'anim-fire' }, { e: 'üéØ', c: 'anim-comp' }
    ];
    let iconStep = 0;
    function runDashboardAnimations() {
        const container = document.getElementById('animation-container');
        container.innerHTML = '';
        const item = document.createElement('span');
        item.className = 'char-icon ' + iconData[iconStep].c;
        item.innerText = iconData[iconStep].e;
        item.style.display = 'block';
        container.appendChild(item);
        iconStep = (iconStep + 1) % iconData.length;
        setTimeout(runDashboardAnimations, 3200);
    }
    runDashboardAnimations();

    window.onload = () => {
        if(!API_KEY) document.getElementById('setup-modal').style.display = 'flex';
        setTheme(localStorage.getItem('shrawan_theme') || 'dark');
    };

    function saveApiKey() {
        const key = document.getElementById('api-key-input').value.trim();
        if(key) {
            localStorage.setItem('shrawan_ai_key', key);
            API_KEY = key;
            document.getElementById('setup-modal').style.display = 'none';
        }
    }

    function toggleSidebar() { document.getElementById('sidebar').classList.toggle('active'); }
    
    function setTheme(t) {
        document.documentElement.setAttribute('data-theme', t);
        localStorage.setItem('shrawan_theme', t);
        document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('t-' + t)?.classList.add('active');
    }

    // IMAGE HANDLING (VISION)
    function handleImage(e) {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = (f) => {
            currentImageBase64 = f.target.result;
            document.getElementById('preview-img').src = currentImageBase64;
            document.getElementById('preview-box').style.display = 'block';
        };
        reader.readAsDataURL(file);
    }
    function clearImage() { currentImageBase64 = null; document.getElementById('preview-box').style.display = 'none'; }

    // --- CORE AI LOGIC (YOUTUBE EXPERT + VISION + SECURITY) ---
    async function startInference() {
        const input = document.getElementById('user-input');
        const prompt = input.value.trim();
        if(!prompt && !currentImageBase64) return;

        document.getElementById('dashboard-ui').style.display = 'none';
        const flow = document.getElementById('chat-flow');
        flow.style.display = 'flex';

        // Add User Message
        const uDiv = document.createElement('div');
        uDiv.className = 'msg-container user-msg';
        uDiv.innerHTML = `${prompt}${currentImageBase64 ? `<br><img src="${currentImageBase64}" style="width:250px; border-radius:15px; margin-top:10px; border:1px solid #555;">` : ''}`;
        flow.appendChild(uDiv);
        input.value = '';

        const bDiv = document.createElement('div');
        bDiv.className = 'msg-container bot-msg';
        bDiv.innerHTML = `<span style="color:var(--accent-color); font-weight:bold; animation:pulse 1s infinite;">ShrawanChatAI is analyzing... ‚ö°</span>`;
        flow.appendChild(bDiv);
        scrollToBottom();

        // MASTER SYSTEM PROMPT
        const systemPrompt = `You are ShrawanChatAI, a world-class AI Assistant and YouTube Guru created by Shrawan Ji.
1. YouTube Expertise: If asked about YouTube, provide Viral SEO Titles, Professional Descriptions, and 20+ Trending Tags separated by commas. 
2. Style: Every sentence must contain highly relevant emojis. Be professional yet friendly.
3. Security Guardrail: If a user asks for anything illegal, dangerous, adult, or harmful, you MUST NOT answer. Instead, reply EXACTLY with this HTML: 
<div class='illegal-warning'>üö´ PITAOGE DIMAK SAHI HO JAYEGA <br><br> YOU WILL BE BEATEN, YOUR MIND WILL BE FIXED üö´</div>
4. Vision: If an image is provided, analyze it deeply and answer the user's question accurately.`;

        let messages = [{role: "system", content: systemPrompt}];
        if(currentImageBase64) {
            messages.push({role: "user", content: [{type: "text", text: prompt || "Explain this image in detail."}, {type: "image_url", image_url: {url: currentImageBase64}}]});
        } else {
            messages.push({role: "user", content: prompt});
        }
        clearImage();

        try {
            const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                method: "POST",
                headers: { "Authorization": `Bearer ${API_KEY}`, "Content-Type": "application/json" },
                body: JSON.stringify({
                    "model": "google/gemini-2.0-flash-lite-preview-02-05:free",
                    "messages": messages,
                    "temperature": 0.7
                })
            });
            const data = await response.json();
            let aiReply = data.choices[0].message.content;
            
            // Cleanup text for Voice
            globalBotReply = aiReply.replace(/<[^>]*>?/gm, '').replace(/[*#_]/g, '');
            
            // Format for display
            bDiv.innerHTML = `<div>${aiReply.replace(/\n/g, '<br>')}</div>`;
            saveToHistory(prompt || "Image Analysis");

        } catch (error) {
            bDiv.innerHTML = `<span style="color:red;">‚ö†Ô∏è Error: Connection failed. Check API Key.</span>`;
        }
        scrollToBottom();
    }

    // --- ADAM VOICE CONTROLLER (PLAY/PAUSE/RESUME) ---
    function handleVoicePlayback() {
        const btn = document.getElementById('adam-trigger');
        
        if (synth.speaking && !synth.paused) {
            synth.pause();
            isPaused = true;
            btn.innerText = "play_circle_filled";
            btn.classList.remove('active');
            return;
        }
        
        if (isPaused) {
            synth.resume();
            isPaused = false;
            btn.innerText = "pause_circle_filled";
            btn.classList.add('active');
            return;
        }

        if (!globalBotReply) return;

        synth.cancel();
        currentUtterance = new SpeechSynthesisUtterance(globalBotReply);
        
        // Voice Selection for Adam (Human feel)
        let voices = synth.getVoices();
        let selectedVoice = voices.find(v => v.name.includes('Male') || v.name.includes('UK English'));
        if(selectedVoice) currentUtterance.voice = selectedVoice;
        
        currentUtterance.pitch = 0.85; // Deep Adam style
        currentUtterance.rate = 1.0;
        
        currentUtterance.onstart = () => { btn.innerText = "pause_circle_filled"; btn.classList.add('active'); };
        currentUtterance.onend = () => { btn.innerText = "play_circle_filled"; btn.classList.remove('active'); isPaused = false; };
        
        synth.speak(currentUtterance);
    }

    // SPEECH TO TEXT
    function startSpeechToText() {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if(!SpeechRecognition) return alert("Browser not supported!");
        const rec = new SpeechRecognition();
        rec.lang = 'hi-IN';
        rec.onstart = () => { document.getElementById('user-input').placeholder = "Listening deeply..."; };
        rec.onresult = (e) => { 
            document.getElementById('user-input').value = e.results[0][0].transcript; 
            document.getElementById('user-input').placeholder = "Ask ShrawanChatAI anything...";
            startInference();
        };
        rec.start();
    }

    function scrollToBottom() { const v = document.querySelector('.viewport'); v.scrollTop = v.scrollHeight; }
    
    function saveToHistory(txt) {
        const hist = document.getElementById('chat-history');
        const item = document.createElement('div');
        item.className = 'history-item';
        item.innerText = "üìù " + (txt.length > 25 ? txt.substring(0, 25) + "..." : txt);
        hist.prepend(item);
    }
</script>
</body>
</html>
