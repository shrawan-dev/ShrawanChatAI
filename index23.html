<style>
  /* Shrawan Pro TTS - Download Audio Feature */
  .tts-pro-container {
    max-width: 600px;
    margin: 20px auto;
    padding: 20px;
    background: #ffffff;
    border: 1px solid #ddd;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }
  .tts-header {
    font-size: 20px;
    font-weight: bold;
    color: #1a73e8;
    margin-bottom: 15px;
    text-align: center;
  }
  .tts-pro-container input, .tts-pro-container textarea, .tts-pro-container select {
    width: 100%;
    padding: 12px;
    border: 1px solid #ccc;
    border-radius: 8px;
    font-size: 16px;
    margin-bottom: 15px;
    box-sizing: border-box;
    outline: none;
  }
  .tts-pro-container textarea {
    height: 120px;
    resize: none;
  }
  .tts-pro-container button {
    width: 100%;
    padding: 12px;
    background: #1a73e8;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
  }
  .tts-pro-container button:hover {
    background: #1557b0;
  }
  #audioPlayer {
    width: 100%;
    margin-top: 15px;
    outline: none;
  }
  #downloadBtn {
    display: none;
    text-align: center;
    margin-top: 15px;
    background: #34a853;
    color: white;
    text-decoration: none;
    padding: 12px;
    border-radius: 8px;
    font-weight: bold;
  }
  #downloadBtn:hover {
    background: #2b8742;
  }
</style>

<div class="tts-pro-container">
  <div class="tts-header">Shrawan AI Studio (Audio Generator)</div>
  
  <input type="password" id="apiKeyInput" placeholder="Apni Google API Key yahan paste karein..." />
  
  <textarea id="textInput" placeholder="Wo text likhein jiska audio banana hai..."></textarea>
  
  <select id="languageSelect">
    <option value="hi-IN">Hindi (India)</option>
    <option value="en-US">English (US)</option>
    <option value="en-IN">English (India)</option>
  </select>

  <button onclick="generateAndDownloadAudio()" id="genBtn">Generate Audio ðŸš€</button>
  
  <div id="statusText" style="margin-top:10px; text-align:center; color:#555; font-size:14px;"></div>

  <audio id="audioPlayer" controls style="display:none;"></audio>
  <a id="downloadBtn" download="Shrawan_AI_Audio.mp3">Download MP3 ðŸŽµ</a>
</div>

<script>
  async function generateAndDownloadAudio() {
    let apiKey = document.getElementById('apiKeyInput').value.trim();
    let text = document.getElementById('textInput').value.trim();
    let lang = document.getElementById('languageSelect').value;
    let btn = document.getElementById('genBtn');
    let status = document.getElementById('statusText');
    let player = document.getElementById('audioPlayer');
    let downloadLink = document.getElementById('downloadBtn');

    if (!apiKey) {
      alert("Bhai, pehle apni API Key dalo!");
      return;
    }
    if (!text) {
      alert("Kuch text toh likho!");
      return;
    }

    btn.innerText = "Generating...";
    btn.disabled = true;
    status.innerText = "Audio ban raha hai, thoda wait karo...";
    player.style.display = "none";
    downloadLink.style.display = "none";

    // Google Cloud Text-to-Speech API URL
    let url = `https://texttospeech.googleapis.com/v1/text:synthesize?key=${apiKey}`;
    
    // API ko bhejne wala data
    let requestBody = {
      input: { text: text },
      voice: { languageCode: lang },
      audioConfig: { audioEncoding: "MP3" } // Hame MP3 format chahiye
    };

    try {
      let response = await fetch(url, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(requestBody)
      });

      let data = await response.json();

      if (data.error) {
        status.innerText = "Error aa gaya bhai: " + data.error.message;
        console.error(data.error);
      } else if (data.audioContent) {
        // Base64 audio ko real MP3 link mein convert karna
        let audioSrc = "data:audio/mp3;base64," + data.audioContent;
        
        status.innerText = "Audio Generate ho gaya!";
        
        // Player mein set karna
        player.src = audioSrc;
        player.style.display = "block";
        
        // Download button activate karna
        downloadLink.href = audioSrc;
        downloadLink.style.display = "block";
      }
    } catch (error) {
      status.innerText = "Network ya API error!";
      console.error(error);
    }

    btn.innerText = "Generate Audio ðŸš€";
    btn.disabled = false;
  }
</script>
